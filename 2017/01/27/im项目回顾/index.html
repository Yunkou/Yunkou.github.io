<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> imé¡¹ç›®å›é¡¾ Â· ğŸºå¯‡è€å¸ˆçš„å°ç«™ğŸº</title><meta name="description" content="imé¡¹ç›®å›é¡¾ - Yunkou"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://yoursite.com/atom.xml" title="ğŸºå¯‡è€å¸ˆçš„å°ç«™ğŸº"><meta name="generator" content="Hexo 4.0.0"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/Yunkou" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="https://juejin.im/user/55edc49b60b294604dbc746e" target="_blank" class="nav-list-link">JUEJIN</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">imé¡¹ç›®å›é¡¾</h1><div class="post-info">2017å¹´1æœˆ27æ—¥</div><div class="post-content"><p>å¹´å‰æœ‰å¹¸å’Œå…¶ä»–å‡ ä¸ªä¼˜ç§€çš„åŒäº‹ä¸€èµ·å¼€å‘å®Œæˆimé¡¹ç›®å¼€å‘ã€‚imé¡¹ç›®åœ¨å…¬å¸æ‰€æœ‰äº§å“çº¿ä¸­æ˜¯åŠŸèƒ½æœ€å°‘ä½†æ˜¯ç»†èŠ‚å¤šå¼€å‘éš¾åº¦å¤§ã€‚ä¸€æ–¹é¢æ¥è‡ªäºäº§å“å½¢æ€å±äºå¯Œäº¤äº’ï¼Œç¬¬äºŒç‚¹æ¥è‡ªä¼˜ç§€ä½œå“çš„æ¯”è¾ƒï¼šæ¯”å¦‚é’‰é’‰ï¼Œå¾®ä¿¡ï¼ŒQQç­‰ç­‰ã€‚å¾€å¾€ä¸€ä¸ªçœ‹ä¼¼å¹³å¸¸çš„åŠŸèƒ½ï¼Œå®ç°èµ·æ¥è¦å¤šç«¯é…åˆï¼Œéš¾åº¦çš„è·¨åº¦æ¯”è¾ƒå¤§ã€‚</p>
<p>å…ˆçœ‹æ•ˆæœï¼š çº¿ä¸Šåœ°å€ <a href="https://im.clouderwork.com" target="_blank" rel="noopener">https://im.clouderwork.com</a></p>
<p>imé¡¹ç›®è™½ç„¶å†ç»åå·ï¼Œå•å›å¤´çœ‹ä¹Ÿå¾ˆç²¾å½©å…¶ä¸­æœ‰å¾ˆå¤šå¯åœˆå¯ç‚¹ä¹‹å¤„ï¼Œä¸æ–¹ä¾¿ä¸€ä¸€é“æ¥ï¼Œéšæ‰‹æ‹¿å‡ºå‡ ä¸ªç»å…¸çš„åœºæ™¯æµ…æä¸‹ä½¿ç”¨çš„æ–¹æ¡ˆï¼Œå¸Œæœ›æœ‰æ‰€äº¤æµå’Œå¸®åŠ©</p>
<h3 id="Contenteditable-Vs-Textarea"><a href="#Contenteditable-Vs-Textarea" class="headerlink" title="Contenteditable Vs Textarea"></a>Contenteditable Vs Textarea</h3><p><img src="https://ww4.sinaimg.cn/large/006y8lValy1fc5ka37xufj30rp0khwfi.jpg" alt=""></p>
<p>å‘æ¶ˆæ¯çš„è¾“å…¥æ¡†å¯ä»¥æœ‰ä¸¤ç§æ–¹æ¡ˆï¼š</p>
<p><strong>æ–¹æ¡ˆ1:</strong> ä½¿ç”¨div contenteditable </p>
<p><strong>æ–¹æ¡ˆ2:</strong> ä½¿ç”¨textarea</p>
<p>åˆ†æä¸‹ä¸¤ç§æ–¹æ¡ˆçš„åˆ©å¼Šï¼š<strong>æ–¹æ¡ˆ1</strong>  å¯ä»¥æ’å…¥ä»»æ„æ ‡ç­¾ï¼Œå¯¹äºim å¤šä¸ªæ ‡ç­¾å°±å¯ä»¥å¹²å¾ˆå¤šäº‹ï¼Œæ¯”å¦‚æ ‡è®°@çš„ä¿¡æ¯ï¼Œå±•ç¤ºè¡¨æƒ…ã€‚é¡¹ç›®åˆæœŸæˆ‘ä»¬ä½¿ç”¨çš„æ­¤æ–¹æ¡ˆï¼Œç¾ä¸­ä¸è¶³ä¸å…¼å®¹å…¶ä»–ç«¯ï¼Œä¹Ÿå°±æ˜¯å‰ç«¯å¯ä»¥éšæ„å±•ç¤ºhtml ä½†æ˜¯å®‰å“ç«¯å’Œiosç«¯ä¸èƒ½åœ¨æ¶ˆæ¯ä½“ä¸­å¸¦æœ‰htmlæ ‡ç­¾  <strong>æ–¹æ¡ˆ2:</strong> æ˜¯çº¯ å­—ç¬¦ä¸²è§£å†³æ–¹æ¡ˆï¼Œå…¼å®¹å…¶ä»–ç«¯ï¼Œå˜æˆäº†æ“ä½œå­—ç¬¦ä¸²ã€‚ç›¸åº”çš„è¡¨æƒ…ä¸èƒ½å±•ç¤ºæˆå›¾ç‰‡ï¼Œåªèƒ½<code>[å¼€å¿ƒ]</code>è¿™æ ·å±•ç¤ºã€‚å‡ ç»æ²Ÿé€šæœ€åç¡®å®šè¿˜æ˜¯é‡‡ç”¨äº†æ–¹æ¡ˆ2</p>
<p>ä¸‹é¢åˆ†äº«ä¸‹æ–¹æ¡ˆ2çš„éš¾ç‚¹</p>
<p>å¦‚æœæ˜¯æ–¹æ¡ˆ1 æˆ‘ä»¬å¯ä»¥@äººçš„æ—¶å€™ åŠ å…¥ä¸€ä¸ª<code>span</code> æ ‡ç­¾ <code>&lt;span contenteditable=&quot;false&quot; data-id=&#39;xxxxx&#39;&gt;@è·¯é£&lt;/span&gt;</code> è¿™æ ·æˆ‘ä»¬è§£æçš„æ—¶å€™éå¸¸å¥½è§£æï¼Œè¿˜æœ‰ä¸ªé—®é¢˜ï¼Œå•æˆ‘ä»¬åˆ é™¤@çš„äººçš„æ—¶å€™ æ˜¯æ•´ä¸ª@è·¯é£ä¸€èµ·åˆ é™¤ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªä¸ªå­—åˆ é™¤ã€‚</p>
<p>åœ¨çº¯å­—ç¬¦ä¸²ä¸­å»è§£å†³è¿™ä¸ªé—®é¢˜å°±ä¸å¥½è§£å†³äº†ã€‚é¡ºå¸¦è¿˜æœ‰ä¸€äº›å…¶ä»–é—®é¢˜æ¯”å¦‚ï¼šé”®ç›˜å·¦å³é”®ï¼Œç»è¿‡ @è·¯é£çš„æ—¶å€™è¦è·³è¿‡å»ï¼Œä¸èƒ½åœç•™åœ¨ @è·¯é£ ä¹‹é—´ï¼Œä¸èƒ½ç ´å@çš„ç»“æ„ã€‚ é¼ æ ‡å•å‡»è¦è®©å…‰æ ‡è½åœ¨ @è·¯é£ çš„å‰é¢æˆ–è€…åé¢ã€‚</p>
<p>è¯¥åŠŸèƒ½å‚ç…§é’‰é’‰å®¢æˆ·ç«¯çš„å®ç°ã€‚</p>
<p>ä¸ºäº†æ›´å¥½çš„äº¤æµï¼Œæˆ‘æŠŠä»£ç ä¹Ÿå¼€æºå‡ºæ¥ï¼Œå¸Œæœ›èƒ½æœ‰æ›´å¥½çš„è§£å†³æ–¹æ¡ˆã€‚ä½“éªŒæ•ˆæœï¼š<a href="http://kouyun.me/Vue-textarea/" target="_blank" rel="noopener">http://kouyun.me/Vue-textarea/</a></p>
<p><a href="https://github.com/Yunkou/Vue-textarea/tree/gh-pages" target="_blank" rel="noopener">https://github.com/Yunkou/Vue-textarea/tree/gh-pages</a> ä»£ç åœ¨æ­¤</p>
<p><img src="https://ww1.sinaimg.cn/large/006y8lValy1fc5kuup220j30fv0fyt9f.jpg" alt=""></p>
<p>è¯´ä¸‹å¤§æ¦‚çš„æ€è·¯ï¼š</p>
<p>æ•´ä¸ªæ“ä½œéƒ½æ˜¯åœ¨è®¡ç®—å…‰æ ‡å’Œå­—ç¬¦ä¸²index çš„å…³ç³»ã€‚ä¼šç»´æŠ¤ä¸€ä¸ªæ•°ç»„å­˜å‚¨@çš„ä¿¡æ¯ï¼Œè®°å½•è¿™ä¸ª@å¼€å§‹çš„ä½ç½®ï¼Œç»“æŸçš„ä½ç½®å’Œä¸€äº›ç‰¹å¾ä¿¡æ¯æ¯”å¦‚idã€‚</p>
<p>æ ¸å¿ƒä»£ç ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> REX = <span class="regexp">/\s@\S+\s/g</span></span><br><span class="line"><span class="keyword">let</span> arr</span><br><span class="line"><span class="keyword">let</span> posArr = []</span><br><span class="line"><span class="keyword">while</span> ((arr = REX.exec(val)) !== <span class="literal">null</span>) &#123;</span><br><span class="line"><span class="keyword">let</span> pos = &#123;</span><br><span class="line">  start: arr.index,</span><br><span class="line">  end: REX.lastIndex</span><br><span class="line">&#125;</span><br><span class="line">posArr.push(pos)</span><br></pre></td></tr></table></figure>

<p>åˆ©ç”¨æ­£åˆ™å¯¹è±¡exec æ–¹æ³• ä¸æ–­è¿­ä»£ã€‚æ‰¾åˆ°å¼€å§‹ç‚¹å’Œç»“æŸç‚¹ã€‚</p>
<p>å•å…¶ä»–ç›¸å…³æ“ä½œçš„æ—¶å€™ï¼Œéå†å…‰æ ‡æ˜¯å¦åœ¨è¿™ä¸ªåŒºé—´å†…ï¼Œä¸€æ—¦è¿›å…¥è¿™ä¸ªåŒºé—´ç«‹å³ç»™äºˆç›¸åº”çš„å¤„ç†ã€‚</p>
<p>ç¬¬äºŒä¸ªéš¾ç‚¹textarea æ˜¯æ²¡æ³•æ‹¿åˆ°å…‰æ ‡çš„åæ ‡<br>è¿™é‡Œæ¯”è¾ƒç»•ï¼Œä¸æ˜¯å…‰æ ‡çš„ä½ç½® indexï¼Œè€Œæ˜¯å®šä½ fixed position ä¹Ÿå°±æ˜¯ç›¸å¯¹é¡µé¢ä½ç½®ã€‚è¿™ä¸ªè¯¥å¦‚ä½•è®¡ç®—ï¼Œä¸€ç›´æ˜¯ä¸ªéš¾ç‚¹ï¼Œè¿™ä¸ªé—®é¢˜ç”¨æ¥è§£å†³ï¼Œæ‰‹åŠ¨è¾“å…¥@çš„æ—¶å€™ï¼Œæ­£ç¡®çš„åœ¨å…‰æ ‡å®šä½å¤„å‡ºç° @çš„äººå‘˜åˆ—è¡¨ã€‚å…‰æ ‡æ˜¯æ— æ³•è®¡ç®—çš„ã€‚åæ¥æƒ³äº†ä¸€ä¸ªä»£ç†å¸ƒå±€çš„æ–¹å¼ï¼Œå³åœ¨ textarea ä¸‹æ–¹ ç”¨ä¸€ä¸ªpreæ ‡ç­¾æ¥æ¨¡æ‹Ÿ textarea æ ‡ç­¾å¸ƒå±€ã€‚å½“textareaç›‘å¬åˆ°è¾“å…¥@ï¼ˆä¿®é¥°é”®50ä¸”shiftä¿®é¥°é”®å€¼ä¸ºtrueï¼‰ï¼Œåœ¨preå…‰æ ‡å¤„ï¼ˆå­—ç¬¦ä¸²indexï¼‰æ’å…¥ ç©ºspanæ ‡ç­¾ã€‚ç„¶åç”¨domæ ‘æ‰¾åˆ°æ’å…¥çš„ç©ºspanæ ‡ç­¾è®¡ç®—å‡ºä½ç½®ï¼Œå¹¶æ˜ å°„åˆ°textareaæ­£ç¡®çš„ä½ç½®ã€‚</p>
<p>æ ¸å¿ƒä»£ç ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!e.shiftKey) &#123; <span class="keyword">return</span> &#125;</span><br><span class="line"><span class="keyword">let</span> index = <span class="built_in">document</span>.querySelector(<span class="string">'textarea'</span>).selectionStart</span><br><span class="line"><span class="keyword">let</span> tmpStr = <span class="keyword">this</span>.textValue</span><br><span class="line"><span class="keyword">let</span> pre = <span class="built_in">document</span>.querySelector(<span class="string">'.textarea'</span>)</span><br><span class="line">pre.innerHTML = tmpStr.substring(<span class="number">0</span>, index) + <span class="string">'&lt;span&gt;&lt;/span&gt;'</span> + tmpStr.substring(index, tmpStr.length)</span><br><span class="line"><span class="keyword">let</span> span = pre.querySelector(<span class="string">'span'</span>)</span><br><span class="line"><span class="keyword">let</span> left = span.offsetLeft - pre.offsetLeft</span><br><span class="line"><span class="keyword">let</span> bottom = <span class="number">150</span> - (span.offsetTop - pre.offsetTop)</span><br><span class="line"><span class="comment">// å°äº0æ—¶æ ¹æ®æ»šåŠ¨é«˜åº¦æ¥è®¡ç®—ä½ç½®</span></span><br><span class="line"><span class="keyword">if</span> (bottom &lt; <span class="number">0</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> scrollHeight = pre.scrollHeight</span><br><span class="line">  bottom = scrollHeight - <span class="number">10</span> - (span.offsetTop - pre.offsetTop)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">this</span>.atListPos = &#123;</span><br><span class="line">  left: left + <span class="number">10</span> + <span class="string">'px'</span>,</span><br><span class="line">  bottom: bottom + <span class="string">'px'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>imå¯ä»¥è¯´æ˜¯æŠ€æœ¯çš„ä¸€ä¸ªæ— åº•æ´ï¼Œå¤„ç†çš„æŠ€æœ¯ç»†èŠ‚ç‰¹åˆ«å¤šï¼Œéšç€æ…¢æ…¢çš„æ‰“ç£¨è¶Šæ¥è¶Šå–œæ¬¢ä¸Šè¿™ä¸ªé¡¹ç›®ï¼Œå¤§èƒ†å®è·µï¼Œè°¨æ…æ±‚è¯ã€‚</p>
<p>æ–‡å†™äº2017é™¤å¤•å¤œï¼Œç¥è‡ªå·±å’Œæœ‹å‹äº²äººæ–°å¹´å¿«ä¹ã€‚</p>
</div></article></div></main><footer><div class="paginator"><a href="/2017/02/10/%E3%80%8A%E9%B8%9F%E5%93%A5%E7%9A%84%E7%A7%81%E6%88%BF%E8%8F%9C%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-%E4%B8%80/" class="prev">ä¸Šä¸€ç¯‡</a><a href="/2016/12/23/algorithm-in-javascript-quick-sort/" class="next">ä¸‹ä¸€ç¯‡</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'yunkou-blog';
var disqus_identifier = '2017/01/27/imé¡¹ç›®å›é¡¾/';
var disqus_title = 'imé¡¹ç›®å›é¡¾';
var disqus_url = 'http://yoursite.com/2017/01/27/imé¡¹ç›®å›é¡¾/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//yunkou-blog.disqus.com/count.js" async></script><div class="copyright"><p>Â© 2018 - 2019 <a href="http://yoursite.com">Yunkou</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-71814553-1",'auto');ga('send','pageview');</script></body></html>